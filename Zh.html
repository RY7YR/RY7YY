<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ù…ØªØ¬Ø± Ø§Ù„Ø£Ù†Ø§Ù‚Ø© â€” Ù†Ø³Ø®Ø© Ù…ØªÙ‚Ø¯Ù…Ø©</title>
<style>
  :root{
    --p1:#667eea; --p2:#764ba2; --accent:#ff6b6b;
    --bg:#f5f7fb; --card:#ffffff; --muted:#7d8799;
    --glass: rgba(255,255,255,0.06);
  }
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{font-family: "Segoe UI", Tahoma, Verdana, sans-serif;background:var(--bg);color:#122034;line-height:1.45}
  .container{max-width:1180px;margin:0 auto;padding:0 18px}

  /* Header */
  header{position:sticky;top:0;z-index:999;background:linear-gradient(135deg,var(--p1),var(--p2));padding:12px 0;box-shadow:0 6px 22px rgba(30,40,80,0.12)}
  .navbar{display:flex;align-items:center;justify-content:space-between;gap:12px}
  .logo{color:#fff;font-weight:800;font-size:1.2rem;display:flex;gap:10px;align-items:center}
  nav ul{display:flex;gap:12px;list-style:none;align-items:center}
  nav a{color:#fff;text-decoration:none;font-weight:700;padding:6px 8px;border-radius:8px}
  nav a.active{background:rgba(255,255,255,0.12)}
  .cart-icon{background:rgba(255,255,255,0.12);color:#fff;padding:8px 12px;border-radius:999px;display:flex;gap:8px;align-items:center;cursor:pointer;font-weight:800}
  .hamburger{display:none;background:transparent;border:0;color:#fff;font-size:1.2rem;padding:6px 10px;border-radius:8px;cursor:pointer}

  /* Layout */
  .hero{background:linear-gradient(135deg,var(--p1),var(--p2));color:#fff;padding:44px 12px;border-bottom-left-radius:20px;border-bottom-right-radius:20px;margin-bottom:18px}
  .hero .container{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
  .hero h1{font-size:1.6rem;margin-bottom:6px}
  .hero p{opacity:0.95}

  .search-row{display:flex;gap:12px;align-items:center;margin:-28px auto 18px;max-width:1180px;padding:0 18px}
  .search-box{flex:1;background:var(--card);padding:12px;border-radius:12px;display:flex;gap:10px;align-items:center;box-shadow:0 10px 30px rgba(18,32,52,0.04)}
  .search-box input{border:0;outline:none;flex:1;font-size:0.95rem}
  .filter{min-width:140px;padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.05);background:var(--card)}

  .section{max-width:1180px;margin:10px auto 28px;padding:0 18px}
  .section-title{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
  .section-title h2{font-size:1.12rem}
  .section-title p{color:var(--muted);font-size:0.95rem}

  /* categories */
  .category-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px}
  .category-card{background:var(--card);border-radius:12px;padding:14px;display:flex;gap:12px;align-items:center;cursor:pointer;box-shadow:0 8px 28px rgba(18,32,52,0.04);transition:transform .18s}
  .category-card:hover{transform:translateY(-6px)}
  .category-emoji{font-size:1.9rem}
  .category-info h3{color:var(--p1);font-weight:800}
  .category-info p{color:var(--muted);font-size:0.95rem}

  /* products */
  .product-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:14px}
  .product-card{background:var(--card);border-radius:12px;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 8px 30px rgba(18,32,52,0.04);transition:transform .2s}
  .product-card:hover{transform:translateY(-8px)}
  .product-media{height:220px;background:linear-gradient(135deg,#f093fb 0%, #f5576c 100%);display:flex;align-items:center;justify-content:center;position:relative}
  .product-media img{max-width:86%;max-height:86%;object-fit:contain;border-radius:8px}
  .badge{position:absolute;top:12px;left:12px;background:var(--accent);color:#fff;padding:6px 10px;border-radius:999px;font-weight:800}
  .product-body{padding:14px;display:flex;flex-direction:column;gap:10px;flex:1}
  .product-title{font-weight:900;color:#122034}
  .desc{color:var(--muted);font-size:0.95rem}
  .price-row{display:flex;justify-content:space-between;align-items:center;gap:12px}
  .price{color:var(--p1);font-weight:900}
  .old-price{text-decoration:line-through;color:var(--muted);font-size:0.95rem}
  .card-actions{display:flex;gap:10px}

  .btn{background:#fff;color:var(--p1);padding:9px 16px;border-radius:28px;border:0;font-weight:800;cursor:pointer;box-shadow:0 8px 24px rgba(39,61,150,0.12)}
  .ghost{background:transparent;border:1px solid rgba(0,0,0,0.06);padding:9px 14px;border-radius:12px}

  /* pages */
  .page{display:none}
  .page.active{display:block}

  /* cart page */
  .cart-grid{display:grid;grid-template-columns:1fr 360px;gap:16px}
  .cart-list{background:var(--card);padding:14px;border-radius:12px;box-shadow:0 8px 24px rgba(18,32,52,0.04)}
  .cart-item{display:flex;gap:12px;align-items:center;padding:10px 0;border-bottom:1px dashed rgba(0,0,0,0.04)}
  .cart-thumb{width:84px;height:84px;border-radius:8px;background:#fff;display:flex;align-items:center;justify-content:center;overflow:hidden}
  .qty-controls{display:flex;gap:6px;align-items:center}
  .qty-controls button{padding:6px 8px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);background:#fff;cursor:pointer}

  /* checkout */
  .checkout-wrap{display:grid;grid-template-columns:1fr 360px;gap:18px}
  .checkout-form{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 8px 30px rgba(18,32,52,0.04)}
  .checkout-summary{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 8px 30px rgba(18,32,52,0.04)}
  .form-row{display:flex;flex-direction:column;gap:8px;margin-bottom:12px}
  label{color:var(--muted);font-weight:700;font-size:0.86rem}
  input,textarea,select{padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);outline:none;font-size:0.96rem}
  textarea{min-height:80px;resize:vertical}
  .coupon-row{display:flex;gap:8px;align-items:center}
  .small-muted{color:var(--muted);font-size:0.92rem}
  .summary-line{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px dashed rgba(0,0,0,0.04)}
  .summary-total{font-weight:900;font-size:1.1rem;color:var(--p1)}

  footer{margin-top:28px;padding:16px 0;color:#51657a}
  .footer-inner{display:flex;justify-content:space-between;flex-wrap:wrap;gap:12px}

  /* small */
  @media(max-width:980px){ .checkout-wrap{grid-template-columns:1fr} .cart-grid{grid-template-columns:1fr} .hamburger{display:block} nav ul{display:none} }
  @media(max-width:520px){ .product-media{height:180px} .product-grid{grid-template-columns:repeat(1,1fr)} .hero .container{flex-direction:column;align-items:flex-start} }
</style>
</head>
<body>
<header>
  <div class="container navbar">
    <div style="display:flex;align-items:center;gap:12px">
      <div class="logo"><span style="font-size:1.4rem">ğŸ‘”</span> Ù…ØªØ¬Ø± Ø§Ù„Ø£Ù†Ø§Ù‚Ø©</div>
    </div>

    <nav aria-label="Ø§Ù„ØªÙ†Ù‚Ù„">
      <button class="hamburger" id="openMenu">â˜°</button>
      <ul id="mainNav">
        <li><a href="#/" data-link>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
        <li><a href="#/category/men" data-link>Ø±Ø¬Ø§Ù„ÙŠ</a></li>
        <li><a href="#/category/women" data-link>Ù†Ø³Ø§Ø¦ÙŠ</a></li>
        <li><a href="#/category/kids" data-link>Ø£Ø·ÙØ§Ù„</a></li>
        <li><a href="#/category/shoes" data-link>Ø£Ø­Ø°ÙŠØ©</a></li>
        <li><a href="#/category/sport" data-link>Ø±ÙŠØ§Ø¶ÙŠ</a></li>
        <li><a href="#/cart" data-link style="background:rgba(255,255,255,0.08);border-radius:8px;padding:6px 10px">Ø§Ù„Ø³Ù„Ø©</a></li>
        <li><a href="#/checkout" data-link>Ø§Ù„Ø¯ÙØ¹</a></li>
      </ul>
    </nav>

    <div style="display:flex;align-items:center;gap:10px">
      <div class="cart-icon" id="cartBtn" aria-label="Ø§Ù„Ø³Ù„Ø©">ğŸ›’ Ø§Ù„Ø³Ù„Ø© (<span id="cartCount">0</span>)</div>
    </div>
  </div>
</header>

<section class="hero">
  <div class="container">
    <div>
      <h1>Ø£Ø­Ø¯Ø« ØµÙŠØ­Ø§Øª Ø§Ù„Ù…ÙˆØ¶Ø© 2025</h1>
      <p>ØªØµØ§Ù…ÙŠÙ… Ø­Ø¯ÙŠØ«Ø© ÙˆØ¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©. ØªØ¬Ø±Ø¨Ø© ØªØ³ÙˆÙ‚ Ø¨Ø³ÙŠØ·Ø© ÙˆØ³Ù„Ø³Ø©.</p>
    </div>
    <div style="display:flex;gap:8px">
      <button class="btn" id="shopNow">ØªØ³ÙˆÙ‚ Ø§Ù„Ø¢Ù†</button>
      <button class="ghost" id="viewCategories">Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</button>
    </div>
  </div>
</section>

<div class="search-row">
  <div class="search-box container" style="max-width:920px">
    <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35" stroke="#223" stroke-width="1.5" stroke-linecap="round"/><circle cx="11" cy="11" r="6" stroke="#223" stroke-width="1.5"/></svg>
    <input id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." aria-label="Ø¨Ø­Ø«">
    <button class="btn" id="clearSearch">Ù…Ø³Ø­</button>
  </div>

  <select id="categoryFilter" class="filter" aria-label="ÙÙ„ØªØ± Ø§Ù„Ø£Ù‚Ø³Ø§Ù…">
    <option value="all">ÙƒÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</option>
    <option value="men">Ù…Ù„Ø§Ø¨Ø³ Ø±Ø¬Ø§Ù„ÙŠØ©</option>
    <option value="women">Ù…Ù„Ø§Ø¨Ø³ Ù†Ø³Ø§Ø¦ÙŠØ©</option>
    <option value="kids">Ù…Ù„Ø§Ø¨Ø³ Ø£Ø·ÙØ§Ù„</option>
    <option value="shoes">Ø£Ø­Ø°ÙŠØ© Ø±ÙŠØ§Ø¶ÙŠØ©</option>
    <option value="sport">Ù…Ù„Ø§Ø¨Ø³ Ø±ÙŠØ§Ø¶ÙŠØ©</option>
  </select>
</div>

<main>
  <!-- Home -->
  <section id="page-home" class="page active">
    <div class="section container">
      <div class="section-title">
        <h2>ØªØµÙØ­ Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©</h2>
        <p>Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù… Ù„Ø±Ø¤ÙŠØ© Ù…Ù†ØªØ¬Ø§ØªÙ‡</p>
      </div>
      <div id="categoryGrid" class="category-grid"></div>
    </div>

    <div class="section container">
      <div class="section-title">
        <h2>Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
        <p id="resultsText">ÙƒÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</p>
      </div>
      <div id="productGrid" class="product-grid"></div>
    </div>
  </section>

  <!-- Category page -->
  <section id="page-category" class="page">
    <div class="section container">
      <div class="section-title">
        <h2 id="categoryTitle">Ù‚Ø³Ù…</h2>
        <p id="categoryDesc">Ø¹Ø±Ø¶ Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù‚Ø³Ù…</p>
      </div>
      <div id="categoryProductGrid" class="product-grid"></div>
    </div>
  </section>

  <!-- Cart page -->
  <section id="page-cart" class="page">
    <div class="section container">
      <div class="section-title">
        <h2>Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚</h2>
        <p>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± Ù‚Ø¨Ù„ Ø§Ù„Ø¯ÙØ¹</p>
      </div>

      <div class="cart-grid">
        <div class="cart-list" id="cartList">
          <!-- Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ù„Ø© -->
        </div>

        <aside class="checkout-summary">
          <h4>Ù…Ù„Ø®Øµ Ø§Ù„Ø³Ù„Ø©</h4>
          <div id="cartSummaryItems" style="margin-top:12px"></div>
          <div style="margin-top:12px">
            <div class="summary-line"><div>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ</div><div id="cartSubTotal">0 Ø±ÙŠØ§Ù„</div></div>
            <div class="summary-line"><div>Ø§Ù„Ø®ØµÙ…</div><div id="cartDiscount">0 Ø±ÙŠØ§Ù„</div></div>
            <div class="summary-line"><div>Ø§Ù„Ø´Ø­Ù†</div><div id="cartShipping">0 Ø±ÙŠØ§Ù„</div></div>
            <div style="margin-top:8px" class="summary-line"><div class="summary-total">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div><div id="cartGrandTotal" class="summary-total">0 Ø±ÙŠØ§Ù„</div></div>
          </div>

          <div style="margin-top:12px;display:flex;gap:8px">
            <input id="cartCoupon" placeholder="ÙƒÙˆØ¯ ÙƒÙˆØ¨ÙˆÙ†" style="flex:1;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06)">
            <button class="btn" id="applyCartCoupon">ØªØ·Ø¨ÙŠÙ‚</button>
          </div>
          <div id="cartCouponMsg" class="small-muted" style="margin-top:8px"></div>

          <div style="margin-top:12px">
            <button class="btn" id="goToCheckout" style="width:100%">Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ø¯ÙØ¹</button>
          </div>
        </aside>
      </div>
    </div>
  </section>

  <!-- Checkout page -->
  <section id="page-checkout" class="page">
    <div class="section container">
      <div class="section-title">
        <h2>ØµÙØ­Ø© Ø§Ù„Ø¯ÙØ¹</h2>
        <p>Ø§Ù…Ù„Ø£ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø­Ù† ÙˆØ·Ø¨Ù‚ ÙƒÙˆØ¨ÙˆÙ† (Ø¥Ù† ÙˆØ¬Ø¯)</p>
      </div>

      <div class="checkout-wrap">
        <div class="checkout-form">
          <h3 style="margin-bottom:12px">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø­Ù†</h3>

          <div class="form-row">
            <label for="phone">Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</label>
            <input id="phone" placeholder="Ù…Ø«Ø§Ù„: 0591234567" inputmode="tel" />
            <div id="phoneError" class="small-muted" style="color:#d9534f;display:none">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø¬ÙˆØ§Ù„ ØµØ§Ù„Ø­</div>
          </div>

          <div class="form-row">
            <label for="address">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
            <textarea id="address" placeholder="Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©ØŒ Ø§Ù„Ø­ÙŠØŒ Ø§Ù„Ø´Ø§Ø±Ø¹ØŒ Ø±Ù‚Ù… Ø§Ù„Ù…Ù†Ø²Ù„"></textarea>
          </div>

          <div class="form-row">
            <label for="coupon">Ø±Ù…Ø² Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†</label>
            <div class="coupon-row">
              <input id="coupon" placeholder="Ù…Ø«Ø§Ù„: SAVE10 Ø£Ùˆ ELEGANCE20">
              <button class="btn" id="applyCoupon">ØªØ·Ø¨ÙŠÙ‚</button>
            </div>
            <div id="couponMsg" class="small-muted" style="margin-top:6px"></div>
          </div>

          <div style="margin-top:18px;display:flex;gap:10px">
            <button class="btn" id="completePayment" style="flex:1">Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¯ÙØ¹</button>
            <button class="ghost" id="backShop">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØªØ³ÙˆÙ‚</button>
          </div>

          <p class="small-muted" style="margin-top:12px">Ù…Ù„Ø§Ø­Ø¸Ø©: Ø²Ø± "Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¯ÙØ¹" Ù„Ø§ ÙŠÙ†ÙÙ‘Ø° Ø¯ÙØ¹Ù‹Ø§ Ø­Ù‚ÙŠÙ‚ÙŠÙ‹Ø§ â€” ÙŠÙ…ÙƒÙ†Ùƒ Ø±Ø¨Ø·Ù‡ Ø¨Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¯ÙØ¹ Ù„Ø§Ø­Ù‚Ù‹Ø§.</p>
        </div>

        <aside class="checkout-summary">
          <h4>Ù…ÙˆØ¬Ø² Ø§Ù„Ø³Ù„Ø©</h4>
          <div id="summaryItems" style="margin-top:12px"></div>

          <div style="margin-top:12px">
            <div class="summary-line"><div>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ù‚Ø¨Ù„ Ø§Ù„Ø®ØµÙ…</div><div id="subTotal">0 Ø±ÙŠØ§Ù„</div></div>
            <div class="summary-line"><div>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…</div><div id="discountVal">0 Ø±ÙŠØ§Ù„</div></div>
            <div class="summary-line"><div>Ø§Ù„Ø´Ø­Ù†</div><div id="shippingVal">0 Ø±ÙŠØ§Ù„</div></div>
            <div style="margin-top:8px" class="summary-line"><div class="summary-total">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ…</div><div id="grandTotal" class="summary-total">0 Ø±ÙŠØ§Ù„</div></div>
          </div>

          <div style="margin-top:12px">
            <div class="small-muted">Ø³ÙŠÙØ­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ Ù…Ø­Ù„ÙŠØ§Ù‹ ÙˆÙŠÙ…ÙƒÙ†Ùƒ Ø±Ø¨Ø·Ù‡ Ø¨Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¯ÙØ¹ Ù„Ø§Ø­Ù‚Ù‹Ø§.</div>
          </div>
        </aside>
      </div>
    </div>
  </section>
</main>

<footer>
  <div class="container footer-inner">
    <div>Â© 2025 Ù…ØªØ¬Ø± Ø§Ù„Ø£Ù†Ø§Ù‚Ø© â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</div>
    <div class="small-muted">Ù†Ø³Ø®Ø© Ù…Ø­Ù„ÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø©: ØµÙØ­Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© ÙÙŠ Ù…Ù„Ù ÙˆØ§Ø­Ø¯.</div>
  </div>
</footer>

<script>
/* ===========================
   Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØªÙ‡ÙŠØ¦Ø©
   =========================== */
const PRODUCTS = [
  {id:1,title:'Ù‚Ù…ÙŠØµ ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ',price:150,oldPrice:200,cat:'men',badge:'Ø¬Ø¯ÙŠØ¯',img:null,desc:'Ù‚Ù…ÙŠØµ Ù‚Ø·Ù† Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø©.'},
  {id:2,title:'ÙØ³ØªØ§Ù† ØµÙŠÙÙŠ',price:210,oldPrice:300,cat:'women',badge:'Ø®ØµÙ… 30%',img:null,desc:'ÙØ³ØªØ§Ù† Ù…Ø±ÙŠØ­ ÙˆØ®ÙÙŠÙ.'},
  {id:3,title:'Ø¨Ù†Ø·Ø§Ù„ Ø¬ÙŠÙ†Ø²',price:180,cat:'men',img:null,desc:'Ø¬ÙŠÙ†Ø² Ù‚ÙˆÙŠ ÙˆÙ…Ø±ÙŠØ­.'},
  {id:4,title:'Ø¬Ø§ÙƒÙŠØª Ø´ØªÙˆÙŠ',price:399,oldPrice:500,cat:'men',badge:'Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø¨ÙŠØ¹Ø§Ù‹',img:null,desc:'Ø¬Ø§ÙƒÙŠØª Ø¯Ø§ÙØ¦ ÙˆØ¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø©.'},
  {id:5,title:'Ø­Ø°Ø§Ø¡ Ø±ÙŠØ§Ø¶ÙŠ',price:250,cat:'shoes',img:null,desc:'Ø­Ø°Ø§Ø¡ Ø®ÙÙŠÙ ÙˆÙ…Ø±ÙŠØ­.'},
  {id:6,title:'ØªÙŠØ´ÙŠØ±Øª Ø±ÙŠØ§Ø¶ÙŠ',price:90,cat:'sport',badge:'Ø¬Ø¯ÙŠØ¯',img:null,desc:'ØªÙŠØ´ÙŠØ±Øª Ø³Ø±ÙŠØ¹ Ø§Ù„Ø¬ÙØ§Ù.'},
  {id:7,title:'ÙØ³Ø§ØªÙŠÙ† Ø£Ø·ÙØ§Ù„',price:120,cat:'kids',img:null,desc:'Ù„Ø·ÙŠÙ ÙˆÙ…Ø±ÙŠØ­ Ù„Ù„Ø£Ø·ÙØ§Ù„.'}
];

// ÙƒÙˆØ¨ÙˆÙ†Ø§Øª: Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©
const COUPONS = { 'SAVE10':10, 'ELEGANCE20':20, 'WELCOME5':5 };
const SHIPPING_COST = 15;
const STORAGE_KEY = 'elegance_cart_v2';

// Cart state
let CART = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
let APPLIED_COUPON_CART = null; // Ù…ÙØ¹Ù‘Ù„ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø³Ù„Ø©
let APPLIED_COUPON_CHECKOUT = null; // Ù…ÙØ¹Ù‘Ù„ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø¯ÙØ¹

/* ===========================
   Ø£Ø¯ÙˆØ§Øª ØªÙ†Ø³ÙŠÙ‚
   =========================== */
function formatCurrency(num){
  return new Intl.NumberFormat('ar-SA', {maximumFractionDigits:0}).format(num) + ' Ø±ÙŠØ§Ù„';
}
function placeholderSVG(text,bg1='#fff',bg2='#eef6ff'){
  const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='800' height='800'><defs><linearGradient id='g' x1='0' x2='1'><stop offset='0' stop-color='${bg1}'/><stop offset='1' stop-color='${bg2}'/></linearGradient></defs><rect width='100%' height='100%' fill='url(#g)'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' fill='#7b6b9d' font-family='Segoe UI' font-size='100'>${text}</text></svg>`;
  return `data:image/svg+xml;utf8,${encodeURIComponent(svg)}`;
}

/* ===========================
   Ø¹Ù†Ø§ØµØ± DOM
   =========================== */
const categoryGrid = document.getElementById('categoryGrid');
const productGrid = document.getElementById('productGrid');
const categoryProductGrid = document.getElementById('categoryProductGrid');
const categoryTitle = document.getElementById('categoryTitle');
const categoryDesc = document.getElementById('categoryDesc');
const resultsText = document.getElementById('resultsText');

const searchInput = document.getElementById('searchInput');
const clearSearch = document.getElementById('clearSearch');
const categoryFilter = document.getElementById('categoryFilter');

const cartCountEl = document.getElementById('cartCount');

/* ===========================
   Ø¥Ø¯Ø§Ø±Ø© Ø³Ù„Ø© Ø§Ù„Ø´Ø±Ø§Ø¡
   =========================== */
function saveCart(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(CART)); updateCartUI(); renderCartPage(); renderCheckoutSummary(); }
function updateCartUI(){
  const count = Object.values(CART).reduce((s,n)=>s+n,0);
  cartCountEl.textContent = count;
}

function addToCart(id,qty=1){
  CART[id] = (CART[id]||0) + qty;
  saveCart();
}

function setCartQty(id,qty){
  if(qty<=0) { delete CART[id]; }
  else CART[id] = qty;
  saveCart();
}

function removeFromCart(id){
  delete CART[id];
  saveCart();
}

/* ===========================
   Ø¨Ù†Ø§Ø¡ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø§Øª
   =========================== */
function buildCategories(){
  const cats = [
    {id:'men',title:'Ù…Ù„Ø§Ø¨Ø³ Ø±Ø¬Ø§Ù„ÙŠØ©',emoji:'ğŸ‘•'},
    {id:'women',title:'Ù…Ù„Ø§Ø¨Ø³ Ù†Ø³Ø§Ø¦ÙŠØ©',emoji:'ğŸ‘—'},
    {id:'kids',title:'Ù…Ù„Ø§Ø¨Ø³ Ø£Ø·ÙØ§Ù„',emoji:'ğŸ‘¶'},
    {id:'shoes',title:'Ø£Ø­Ø°ÙŠØ© Ø±ÙŠØ§Ø¶ÙŠØ©',emoji:'ğŸ‘Ÿ'},
    {id:'sport',title:'Ù…Ù„Ø§Ø¨Ø³ Ø±ÙŠØ§Ø¶ÙŠØ©',emoji:'ğŸƒ'}
  ];
  categoryGrid.innerHTML = '';
  cats.forEach(c=>{
    const count = PRODUCTS.filter(p=>p.cat===c.id).length;
    const el = document.createElement('div'); el.className='category-card';
    el.innerHTML = `<div style="display:flex;align-items:center;gap:12px"><div class="category-emoji">${c.emoji}</div><div class="category-info"><h3>${c.title}</h3><p>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ${count}</p></div></div>`;
    el.addEventListener('click', ()=> location.hash = '#/category/'+c.id );
    categoryGrid.appendChild(el);
  });
}

function createProductCard(p){
  const el = document.createElement('div'); el.className='product-card';
  const img = p.img || placeholderSVG(p.title.charAt(0),'#fff','#eef6ff');
  el.innerHTML = `
    <div class="product-media"><img loading="lazy" src="${img}" alt="${p.title}">${p.badge? `<div class="badge">${p.badge}</div>`:''}</div>
    <div class="product-body">
      <div><div class="product-title">${p.title}</div><div class="desc">${p.desc}</div></div>
      <div style="margin-top:auto" class="price-row">
        <div><div class="price">${formatCurrency(p.price)}</div>${p.oldPrice? `<div class="old-price">${formatCurrency(p.oldPrice)}</div>`:''}</div>
        <div class="card-actions">
          <button class="ghost details-btn" data-id="${p.id}">Ø¹Ø±Ø¶</button>
          <button class="btn add-btn" data-id="${p.id}">Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©</button>
        </div>
      </div>
    </div>`;
  return el;
}

function renderAllProducts(){
  const q = (searchInput.value||'').trim().toLowerCase();
  const catSel = categoryFilter.value;
  let results = PRODUCTS.filter(p=>{
    if(catSel!='all' && p.cat!==catSel) return false;
    if(q && !(p.title.toLowerCase().includes(q) || (p.desc&&p.desc.toLowerCase().includes(q)))) return false;
    return true;
  });
  productGrid.innerHTML = '';
  if(!results.length) productGrid.innerHTML = `<div style="padding:18px;background:var(--card);border-radius:10px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</div>`;
  else results.forEach(p=> productGrid.appendChild(createProductCard(p)));
  resultsText.textContent = `Ø¹Ø±Ø¶ ${results.length} Ù…Ù†ØªØ¬`;
  attachProductEvents();
}

function renderCategoryPage(catId){
  const map = {men:'Ù…Ù„Ø§Ø¨Ø³ Ø±Ø¬Ø§Ù„ÙŠØ©',women:'Ù…Ù„Ø§Ø¨Ø³ Ù†Ø³Ø§Ø¦ÙŠØ©',kids:'Ù…Ù„Ø§Ø¨Ø³ Ø£Ø·ÙØ§Ù„',shoes:'Ø£Ø­Ø°ÙŠØ© Ø±ÙŠØ§Ø¶ÙŠØ©',sport:'Ù…Ù„Ø§Ø¨Ø³ Ø±ÙŠØ§Ø¶ÙŠØ©'};
  categoryTitle.textContent = map[catId] || 'Ù‚Ø³Ù…';
  categoryDesc.textContent = `Ø¹Ø±Ø¶ ${categoryTitle.textContent}`;
  const results = PRODUCTS.filter(p=>p.cat===catId);
  categoryProductGrid.innerHTML = '';
  if(!results.length) categoryProductGrid.innerHTML = `<div style="padding:18px;background:var(--card);border-radius:10px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù…</div>`;
  else results.forEach(p=> categoryProductGrid.appendChild(createProductCard(p)));
  attachProductEvents();
}

/* ===========================
   Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
   =========================== */
function attachProductEvents(){
  document.querySelectorAll('.add-btn').forEach(btn=>{
    btn.removeEventListener('click', onAddBtn);
    btn.addEventListener('click', onAddBtn);
  });
  document.querySelectorAll('.details-btn').forEach(btn=>{
    btn.removeEventListener('click', onDetails);
    btn.addEventListener('click', onDetails);
  });
}
function onAddBtn(e){
  const id = parseInt(e.currentTarget.dataset.id);
  addToCart(id,1);
  e.currentTarget.textContent = 'âœ“ ØªÙ…';
  setTimeout(()=> e.currentTarget.textContent = 'Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©',900);
}
function onDetails(e){
  const id = parseInt(e.currentTarget.dataset.id);
  const p = PRODUCTS.find(x=>x.id===id);
  if(!p) return;
  // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø¨Ø³ÙŠØ·Ø© â€” Ù†Ø³ØªØ®Ø¯Ù… alert ÙÙ‚Ø· Ù„Ù„Ø¨Ø³Ø§Ø·Ø© Ù‡Ù†Ø§
  alert(`${p.title}\n\n${p.desc}\n\nØ§Ù„Ø³Ø¹Ø±: ${formatCurrency(p.price)}`);
}

/* ===========================
   ØµÙØ­Ø© Ø§Ù„Ø³Ù„Ø© (editable)
   =========================== */
function renderCartPage(){
  const cartList = document.getElementById('cartList');
  cartList.innerHTML = '<h3 style="margin-bottom:12px">Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ù„Ø©</h3>';
  if(Object.keys(CART).length===0){
    cartList.innerHTML += `<div style="padding:18px;background:var(--card);border-radius:10px">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©. Ø£Ø¶Ù Ù…Ù†ØªØ¬Ø§Øª Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©.</div>`;
  } else {
    Object.keys(CART).forEach(k=>{
      const p = PRODUCTS.find(x=>x.id==k);
      const q = CART[k];
      if(!p) return;
      const div = document.createElement('div'); div.className='cart-item';
      div.innerHTML = `
        <div style="display:flex;gap:12px;align-items:center">
          <div class="cart-thumb"><img src="${p.img||placeholderSVG(p.title.charAt(0),'#fff','#eef6ff')}" alt="${p.title}" style="width:100%;height:100%;object-fit:cover"></div>
          <div>
            <div style="font-weight:800">${p.title}</div>
            <div class="small-muted" style="margin-top:6px">${formatCurrency(p.price)}</div>
          </div>
        </div>
        <div style="display:flex;flex-direction:column;align-items:flex-start;gap:8px">
          <div class="qty-controls">
            <button data-id="${p.id}" class="qty-dec">-</button>
            <div style="min-width:36px;text-align:center">${q}</div>
            <button data-id="${p.id}" class="qty-inc">+</button>
          </div>
          <div style="display:flex;gap:8px;align-items:center">
            <button class="ghost remove-item" data-id="${p.id}">Ø­Ø°Ù</button>
            <div style="font-weight:800">${formatCurrency(p.price * q)}</div>
          </div>
        </div>
      `;
      cartList.appendChild(div);
    });
    // Ø¥Ø±ÙØ§Ù‚ Ø£Ø­Ø¯Ø§Ø«
    cartList.querySelectorAll('.qty-inc').forEach(b=> b.addEventListener('click', ()=> { const id=b.dataset.id; CART[id]++; saveCart(); renderCartPage(); }));
    cartList.querySelectorAll('.qty-dec').forEach(b=> b.addEventListener('click', ()=> { const id=b.dataset.id; CART[id]--; if(CART[id]<=0) delete CART[id]; saveCart(); renderCartPage(); }));
    cartList.querySelectorAll('.remove-item').forEach(b=> b.addEventListener('click', ()=> { if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Ø§Ù„Ø³Ù„Ø©ØŸ')){ delete CART[b.dataset.id]; saveCart(); renderCartPage(); } }));
  }
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø®Ù„Ø§ØµØ©
  renderCartSummary(APPLIED_COUPON_CART);
}

/* ===========================
   Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¨Ø§Ù„Øº
   =========================== */
function calculateTotals(cartObj, couponCode=null){
  let subtotal = 0;
  Object.keys(cartObj).forEach(k=>{
    const p = PRODUCTS.find(x=>x.id==k);
    if(p) subtotal += p.price * cartObj[k];
  });
  let discount = 0;
  let applied = null;
  if(couponCode){
    couponCode = couponCode.toUpperCase();
    if(COUPONS[couponCode]){ applied = COUPONS[couponCode]; discount = Math.round(subtotal * (applied/100)); }
  }
  const shipping = subtotal>0 ? SHIPPING_COST : 0;
  const total = Math.max(0, subtotal - discount) + shipping;
  return {subtotal, discount, shipping, total, applied};
}

function renderCartSummary(couponCode){
  const elItems = document.getElementById('cartSummaryItems');
  const {subtotal, discount, shipping, total, applied} = calculateTotals(CART, couponCode);
  document.getElementById('cartSubTotal').textContent = formatCurrency(subtotal);
  document.getElementById('cartDiscount').textContent = '-' + formatCurrency(discount);
  document.getElementById('cartShipping').textContent = formatCurrency(shipping);
  document.getElementById('cartGrandTotal').textContent = formatCurrency(total);
  const msg = applied ? `ØªÙ… ØªØ·Ø¨ÙŠÙ‚ ÙƒÙˆØ¨ÙˆÙ†: Ø®ØµÙ… ${applied}%` : '';
  document.getElementById('cartCouponMsg').textContent = msg;
  // items list
  elItems.innerHTML = '';
  if(Object.keys(CART).length===0) elItems.innerHTML = '<div class="small-muted">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</div>';
  else {
    Object.keys(CART).forEach(k=>{
      const p = PRODUCTS.find(x=>x.id==k);
      const q = CART[k];
      if(p) elItems.innerHTML += `<div style="display:flex;justify-content:space-between;padding:6px 0"><div>${p.title} Ã— ${q}</div><div>${formatCurrency(p.price*q)}</div></div>`;
    });
  }
}

/* ===========================
   Checkout rendering
   =========================== */
function renderCheckoutSummary(){
  const {subtotal, discount, shipping, total, applied} = calculateTotals(CART, APPLIED_COUPON_CHECKOUT);
  document.getElementById('subTotal').textContent = formatCurrency(subtotal);
  document.getElementById('discountVal').textContent = '-' + formatCurrency(discount);
  document.getElementById('shippingVal').textContent = formatCurrency(shipping);
  document.getElementById('grandTotal').textContent = formatCurrency(total);
  // items
  const si = document.getElementById('summaryItems');
  si.innerHTML = '';
  if(Object.keys(CART).length===0) si.innerHTML = '<div class="small-muted">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</div>';
  else {
    Object.keys(CART).forEach(k=>{
      const p = PRODUCTS.find(x=>x.id==k), q=CART[k];
      if(p) si.innerHTML += `<div style="display:flex;justify-content:space-between;padding:6px 0"><div>${p.title} Ã— ${q}</div><div>${formatCurrency(p.price*q)}</div></div>`;
    });
  }
}

/* ===========================
   Router (hash)
   =========================== */
function showPage(id){
  document.querySelectorAll('.page').forEach(p=> p.classList.remove('active'));
  document.querySelectorAll('[data-link]').forEach(a=> a.classList.remove('active'));

  if(id==='home'){ document.getElementById('page-home').classList.add('active'); document.querySelector('a[href="#/"]').classList.add('active'); renderAllProducts(); }
  else if(id.startsWith('category:')){ document.getElementById('page-category').classList.add('active'); const cat = id.split(':')[1]; renderCategoryPage(cat); const link = document.querySelector(`a[href="#/category/${cat}"]`); if(link) link.classList.add('active'); }
  else if(id==='cart'){ document.getElementById('page-cart').classList.add('active'); document.querySelector('a[href="#/cart"]').classList.add('active'); renderCartPage(); }
  else if(id==='checkout'){ document.getElementById('page-checkout').classList.add('active'); document.querySelector('a[href="#/checkout"]').classList.add('active'); renderCheckoutSummary(); }
  else showPage('home');
}

function handleHash(){
  const h = location.hash || '#/';
  if(h==='#/'|| h==='') return showPage('home');
  if(h.startsWith('#/category/')) return showPage('category:'+h.replace('#/category/',''));
  if(h==='#/cart') return showPage('cart');
  if(h==='#/checkout') return showPage('checkout');
  return showPage('home');
}
window.addEventListener('hashchange', handleHash);

/* ===========================
   Ø£Ø­Ø¯Ø§Ø« Ø¹Ø§Ù…Ø©
   =========================== */
document.getElementById('shopNow').addEventListener('click', ()=> location.hash = '#/category/men');
document.getElementById('viewCategories').addEventListener('click', ()=> location.hash = '#/');
document.getElementById('clearSearch').addEventListener('click', ()=> { searchInput.value=''; renderAllProducts(); });
document.getElementById('openMenu').addEventListener('click', ()=> {
  const nav = document.getElementById('mainNav');
  nav.style.display = nav.style.display==='flex' ? 'none' : 'flex';
  nav.style.flexDirection = 'column'; nav.style.gap='8px';
});
document.getElementById('goToCheckout').addEventListener('click', ()=> location.hash = '#/checkout');

/* ÙƒÙˆØ¨ÙˆÙ† Ø§Ù„Ø³Ù„Ø© */
document.getElementById('applyCartCoupon').addEventListener('click', ()=>{
  const code = (document.getElementById('cartCoupon').value||'').trim().toUpperCase();
  if(!code){ APPLIED_COUPON_CART = null; renderCartSummary(null); return; }
  if(COUPONS[code]){ APPLIED_COUPON_CART = code; renderCartSummary(code); document.getElementById('cartCouponMsg').textContent = `ØªÙ… ØªØ·Ø¨ÙŠÙ‚ ÙƒÙˆØ¨ÙˆÙ† ${code} - Ø®ØµÙ… ${COUPONS[code]}%`; }
  else { APPLIED_COUPON_CART = null; renderCartSummary(null); document.getElementById('cartCouponMsg').textContent = 'Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† ØºÙŠØ± ØµØ§Ù„Ø­'; }
});

/* ÙƒÙˆØ¨ÙˆÙ† Checkout */
document.getElementById('applyCoupon').addEventListener('click', ()=>{
  const code = (document.getElementById('coupon').value||'').trim().toUpperCase();
  if(!code){ APPLIED_COUPON_CHECKOUT = null; renderCheckoutSummary(); document.getElementById('couponMsg').textContent=''; return; }
  if(COUPONS[code]){ APPLIED_COUPON_CHECKOUT = code; renderCheckoutSummary(); document.getElementById('couponMsg').textContent = `ØªÙ… ØªØ·Ø¨ÙŠÙ‚ ÙƒÙˆØ¨ÙˆÙ† ${code} - Ø®ØµÙ… ${COUPONS[code]}%`; document.getElementById('couponMsg').style.color='green'; }
  else { APPLIED_COUPON_CHECKOUT = null; renderCheckoutSummary(); document.getElementById('couponMsg').textContent = 'Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† ØºÙŠØ± ØµØ§Ù„Ø­'; document.getElementById('couponMsg').style.color='#d9534f'; }
});

/* Ø²Ø± Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¯ÙØ¹ (Ù„Ø§ ÙŠÙ†ÙÙ‘Ø° Ø¨ÙˆØ§Ø¨Ø©) */
document.getElementById('completePayment').addEventListener('click', ()=>{
  const phone = (document.getElementById('phone').value||'').trim();
  const address = (document.getElementById('address').value||'').trim();
  const phoneError = document.getElementById('phoneError');

  const phoneNorm = phone.replace(/\s+/g,'');
  const phoneValid = /^(0?5\d{8}|5\d{8}|\+9665\d{8}|009665\d{8})$/.test(phoneNorm);
  if(!phoneValid){ phoneError.style.display='block'; return; } else phoneError.style.display='none';

  const totals = calculateTotals(CART, APPLIED_COUPON_CHECKOUT);
  const order = { items:CART, phone, address, coupon: APPLIED_COUPON_CHECKOUT, totals, created_at: new Date().toISOString() };
  localStorage.setItem('elegance_last_order_v2', JSON.stringify(order));
  alert('ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨ Ù…Ø­Ù„ÙŠÙ‹Ø§. Ø§Ù„Ø¢Ù† Ø±Ø¨Ø· Ø²Ø± Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„ Ù…Ø¹ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¯ÙØ¹ Ù…ØªØ±ÙˆÙƒ Ù„Ùƒ.');
});

/* Ø­ÙØ¸ Ø§Ù„Ø³Ù„Ø© Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ±Ø§Øª Ø®Ø§Ø±Ø¬ÙŠØ© */
window.addEventListener('storage', ()=> { CART = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); updateCartUI(); renderCartPage(); renderCheckoutSummary(); });

/* Ø§Ù„Ø¨Ø­Ø« + Ø§Ù„ÙÙ„ØªØ± */
searchInput.addEventListener('input', debounce(()=> renderAllProducts(), 250));
categoryFilter.addEventListener('change', ()=> renderAllProducts());

/* init */
function init(){
  buildCategories(); renderAllProducts(); updateCartUI(); handleHash();
}
init();

/* debounce */
function debounce(fn,ms=200){ let t; return function(...a){ clearTimeout(t); t=setTimeout(()=> fn.apply(this,a), ms); }; }
</script>
</body>
</html>
